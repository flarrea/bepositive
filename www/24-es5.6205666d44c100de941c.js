function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{wWZX:function(e,t,r){"use strict";r.r(t),r.d(t,"PerfilPageModule",(function(){return _}));var n,i=r("ofXK"),a=r("3Pt+"),o=r("TEn/"),c=r("tyNb"),s=r("mrSG"),u=r("fXoL"),l=r("a/9d"),p=r("lGQG"),f=r("Wcq6"),b=(r("6nsN"),r("I/3d")),d=((n=function(){function e(t,r){_classCallCheck(this,e),this.firestore=t,this.authService=r}return _createClass(e,[{key:"getUserProfile",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.getUser();case 2:return t=e.sent,e.abrupt("return",(this.currentUser=t,this.userProfile=this.firestore.doc("userProfile/"+t.uid),this.userProfile.valueChanges()));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateName",value:function(e){return this.userProfile.update({fullName:e})}},{key:"updateEmail",value:function(e,t){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=f.auth.EmailAuthProvider.credential(this.currentUser.email,t),r.prev=1,r.next=4,this.currentUser.reauthenticateWithCredential(n);case 4:return r.next=6,this.currentUser.updateEmail(e);case 6:return r.abrupt("return",this.userProfile.update({email:e}));case 9:r.prev=9,r.t0=r.catch(1),console.error(r.t0);case 12:case"end":return r.stop()}}),r,this,[[1,9]])})))}},{key:"updatePassword",value:function(e,t){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=f.auth.EmailAuthProvider.credential(this.currentUser.email,t),r.prev=1,r.next=4,this.currentUser.reauthenticateWithCredential(n);case 4:return r.abrupt("return",this.currentUser.updatePassword(e));case 7:r.prev=7,r.t0=r.catch(1),console.error(r.t0);case 10:case"end":return r.stop()}}),r,this,[[1,7]])})))}}]),e}()).\u0275fac=function(e){return new(e||n)(u.Rb(b.a),u.Rb(p.a))},n.\u0275prov=u.Gb({token:n,factory:n.\u0275fac,providedIn:"root"}),n);function h(e,t){if(1&e&&(u.Nb(0,"ion-col",12),u.ic(1),u.Mb()),2&e){var r=u.Xb();u.Ab(1),u.kc(" ",null==r.userProfile?null:r.userProfile.fullName," ")}}function m(e,t){1&e&&(u.Nb(0,"ion-col",13),u.Nb(1,"span"),u.ic(2," Toque aqu\xed para editar. "),u.Mb(),u.Mb())}function g(e,t){if(1&e&&(u.Nb(0,"ion-col",12),u.ic(1),u.Mb()),2&e){var r=u.Xb();u.Ab(1),u.kc(" ",null==r.userProfile?null:r.userProfile.email," ")}}function v(e,t){1&e&&(u.Nb(0,"ion-col",13),u.Nb(1,"span"),u.ic(2," Toque aqu\xed para editar. "),u.Mb(),u.Mb())}var w,P,N,y=[{path:"",component:(w=function(){function e(t,r,n,i,a){_classCallCheck(this,e),this._camera=t,this._alertController=r,this.authService=n,this.router=i,this.profileService=a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.profileService.getUserProfile().then((function(t){t.subscribe((function(t){e.userProfile=t}))}))}},{key:"selectImageSource",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={quality:100,destinationType:this._camera.DestinationType.DATA_URL,encodingType:this._camera.EncodingType.JPEG,mediaType:this._camera.MediaType.PICTURE,targetHeight:200,correctOrientation:!0,sourceType:this._camera.PictureSourceType.CAMERA},r={quality:100,destinationType:this._camera.DestinationType.DATA_URL,encodingType:this._camera.EncodingType.JPEG,mediaType:this._camera.MediaType.PICTURE,targetHeight:200,correctOrientation:!0,sourceType:this._camera.PictureSourceType.SAVEDPHOTOALBUM},e.next=4,this._alertController.create({header:"Seleccione una fuente",message:"Seleccione la fuente donde est\xe1 su imagen",buttons:[{text:"C\xe1mara",handler:function(){i._camera.getPicture(t).then((function(e){i.myProfileImage="data:image/jpeg;base64,"+e}))}},{text:"Galer\xeda",handler:function(){i._camera.getPicture(r).then((function(e){i.myProfileImage="data:image/jpeg;base64,"+e}))}}]});case 4:return n=e.sent,e.next=7,n.present();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"logOut",value:function(){var e=this;this.authService.logout().then((function(t){e.router.navigate(["/login"])}),(function(e){console.log(e)}))}},{key:"updateName",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._alertController.create({subHeader:"Your name",inputs:[{type:"text",name:"fullName",placeholder:"Your full name",value:this.userProfile.fullName}],buttons:[{text:"Cancel"},{text:"Save",handler:function(e){r.profileService.updateName(e.fullName)}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"updateEmail",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._alertController.create({inputs:[{type:"text",name:"newEmail",placeholder:"Your new email"},{name:"password",placeholder:"Your password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:function(e){r.profileService.updateEmail(e.newEmail,e.password).then((function(){console.log("Email Changed Successfully")})).catch((function(e){console.log("ERROR: "+e.message)}))}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"updatePassword",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._alertController.create({inputs:[{name:"newPassword",placeholder:"New password",type:"password"},{name:"oldPassword",placeholder:"Old password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:function(e){r.profileService.updatePassword(e.newPassword,e.oldPassword)}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}}]),e}(),w.\u0275fac=function(e){return new(e||w)(u.Kb(l.a),u.Kb(o.b),u.Kb(p.a),u.Kb(c.g),u.Kb(d))},w.\u0275cmp=u.Eb({type:w,selectors:[["app-perfil"]],decls:47,vars:5,consts:[["color","primary"],["slot","end"],["src","https://firebasestorage.googleapis.com/v0/b/sophi-optimism-2020.appspot.com/o/imagenes%2Fimgsocial.png?alt=media&token=70bd5960-b560-415b-a90b-7cc1383d71ab"],[2,"font-weight","600","color","rgba(39, 39, 39, 0.81)","font-size","16px"],[2,"font-weight","600","color","rgb(133, 133, 133)","font-size","14px"],[1,"profile-pic",3,"click"],[3,"src"],[3,"click"],["size","5",1,"text-left"],["class","text-center","size","7",4,"ngIf"],["size","7","class","placeholder-profile text-center",4,"ngIf"],["size","7",1,"placeholder-profile"],["size","7",1,"text-center"],["size","7",1,"placeholder-profile","text-center"]],template:function(e,t){1&e&&(u.Nb(0,"ion-header"),u.Nb(1,"ion-toolbar",0),u.Nb(2,"ion-avatar",1),u.Lb(3,"img",2),u.Mb(),u.Nb(4,"ion-card-content"),u.Nb(5,"h4",3),u.ic(6," Perfil "),u.Mb(),u.Nb(7,"h6",4),u.ic(8," Algunas ideas importantes. "),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Nb(9,"ion-content"),u.Nb(10,"ion-avatar",5),u.Vb("click",(function(){return t.selectImageSource()})),u.Lb(11,"ion-img",6),u.Mb(),u.Nb(12,"ion-card"),u.Nb(13,"ion-card-header"),u.Nb(14,"ion-card-title"),u.ic(15,"Perfil BePositive"),u.Mb(),u.Mb(),u.Nb(16,"ion-card-content"),u.ic(17," Ejemplo del perfil de un usuario "),u.Mb(),u.Mb(),u.Nb(18,"ion-list"),u.Nb(19,"ion-item-divider"),u.Nb(20,"ion-label"),u.ic(21,"Informaci\xf3n Personal"),u.Mb(),u.Mb(),u.Mb(),u.Nb(22,"ion-item",7),u.Vb("click",(function(){return t.updateName()})),u.Nb(23,"ion-label"),u.Nb(24,"ion-grid"),u.Nb(25,"ion-row"),u.Nb(26,"ion-col",8),u.ic(27," Nombre "),u.Mb(),u.hc(28,h,2,1,"ion-col",9),u.hc(29,m,3,0,"ion-col",10),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Nb(30,"ion-item",7),u.Vb("click",(function(){return t.updateEmail()})),u.Nb(31,"ion-label"),u.Nb(32,"ion-grid"),u.Nb(33,"ion-row"),u.Nb(34,"ion-col",8),u.ic(35," Email "),u.Mb(),u.hc(36,g,2,1,"ion-col",9),u.hc(37,v,3,0,"ion-col",10),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Nb(38,"ion-item",7),u.Vb("click",(function(){return t.updatePassword()})),u.Nb(39,"ion-label"),u.Nb(40,"ion-grid"),u.Nb(41,"ion-row"),u.Nb(42,"ion-col",8),u.ic(43," Password "),u.Mb(),u.Nb(44,"ion-col",11),u.Nb(45,"span"),u.ic(46," Toque aqu\xed para editar. "),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Mb()),2&e&&(u.Ab(11),u.ac("src",t.myProfileImage),u.Ab(17),u.ac("ngIf",null==t.userProfile?null:t.userProfile.fullName),u.Ab(1),u.ac("ngIf",!(null!=t.userProfile&&t.userProfile.fullName)),u.Ab(7),u.ac("ngIf",null==t.userProfile?null:t.userProfile.email),u.Ab(1),u.ac("ngIf",!(null!=t.userProfile&&t.userProfile.email)))},directives:[o.v,o.O,o.d,o.j,o.o,o.x,o.i,o.k,o.m,o.D,o.A,o.C,o.z,o.u,o.H,o.n,i.i],styles:[".profile-pic[_ngcontent-%COMP%]{width:200px;height:200px;border:1px solid grey;margin:10px auto}"]}),w)}],M=((N=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ib({type:N}),N.\u0275inj=u.Hb({factory:function(e){return new(e||N)},imports:[[c.i.forChild(y)],c.i]}),N),_=((P=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ib({type:P}),P.\u0275inj=u.Hb({factory:function(e){return new(e||P)},imports:[[i.b,a.d,o.P,M]]}),P)}}]);