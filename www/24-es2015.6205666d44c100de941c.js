(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{wWZX:function(e,t,i){"use strict";i.r(t),i.d(t,"PerfilPageModule",(function(){return y}));var r=i("ofXK"),o=i("3Pt+"),n=i("TEn/"),a=i("tyNb"),l=i("mrSG"),s=i("fXoL"),c=i("a/9d"),u=i("lGQG"),b=i("Wcq6"),d=(i("6nsN"),i("I/3d"));let p=(()=>{class e{constructor(e,t){this.firestore=e,this.authService=t}getUserProfile(){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.authService.getUser();return this.currentUser=e,this.userProfile=this.firestore.doc("userProfile/"+e.uid),this.userProfile.valueChanges()}))}updateName(e){return this.userProfile.update({fullName:e})}updateEmail(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const i=b.auth.EmailAuthProvider.credential(this.currentUser.email,t);try{return yield this.currentUser.reauthenticateWithCredential(i),yield this.currentUser.updateEmail(e),this.userProfile.update({email:e})}catch(r){console.error(r)}}))}updatePassword(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const i=b.auth.EmailAuthProvider.credential(this.currentUser.email,t);try{return yield this.currentUser.reauthenticateWithCredential(i),this.currentUser.updatePassword(e)}catch(r){console.error(r)}}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(d.a),s.Rb(u.a))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function h(e,t){if(1&e&&(s.Nb(0,"ion-col",12),s.ic(1),s.Mb()),2&e){const e=s.Xb();s.Ab(1),s.kc(" ",null==e.userProfile?null:e.userProfile.fullName," ")}}function f(e,t){1&e&&(s.Nb(0,"ion-col",13),s.Nb(1,"span"),s.ic(2," Toque aqu\xed para editar. "),s.Mb(),s.Mb())}function m(e,t){if(1&e&&(s.Nb(0,"ion-col",12),s.ic(1),s.Mb()),2&e){const e=s.Xb();s.Ab(1),s.kc(" ",null==e.userProfile?null:e.userProfile.email," ")}}function g(e,t){1&e&&(s.Nb(0,"ion-col",13),s.Nb(1,"span"),s.ic(2," Toque aqu\xed para editar. "),s.Mb(),s.Mb())}const P=[{path:"",component:(()=>{class e{constructor(e,t,i,r,o){this._camera=e,this._alertController=t,this.authService=i,this.router=r,this.profileService=o}ngOnInit(){this.profileService.getUserProfile().then(e=>{e.subscribe(e=>{this.userProfile=e})})}selectImageSource(){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const e={quality:100,destinationType:this._camera.DestinationType.DATA_URL,encodingType:this._camera.EncodingType.JPEG,mediaType:this._camera.MediaType.PICTURE,targetHeight:200,correctOrientation:!0,sourceType:this._camera.PictureSourceType.CAMERA},t={quality:100,destinationType:this._camera.DestinationType.DATA_URL,encodingType:this._camera.EncodingType.JPEG,mediaType:this._camera.MediaType.PICTURE,targetHeight:200,correctOrientation:!0,sourceType:this._camera.PictureSourceType.SAVEDPHOTOALBUM},i=yield this._alertController.create({header:"Seleccione una fuente",message:"Seleccione la fuente donde est\xe1 su imagen",buttons:[{text:"C\xe1mara",handler:()=>{this._camera.getPicture(e).then(e=>{this.myProfileImage="data:image/jpeg;base64,"+e})}},{text:"Galer\xeda",handler:()=>{this._camera.getPicture(t).then(e=>{this.myProfileImage="data:image/jpeg;base64,"+e})}}]});yield i.present()}))}logOut(){this.authService.logout().then(e=>{this.router.navigate(["/login"])},e=>{console.log(e)})}updateName(){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._alertController.create({subHeader:"Your name",inputs:[{type:"text",name:"fullName",placeholder:"Your full name",value:this.userProfile.fullName}],buttons:[{text:"Cancel"},{text:"Save",handler:e=>{this.profileService.updateName(e.fullName)}}]});return yield e.present()}))}updateEmail(){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._alertController.create({inputs:[{type:"text",name:"newEmail",placeholder:"Your new email"},{name:"password",placeholder:"Your password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:e=>{this.profileService.updateEmail(e.newEmail,e.password).then(()=>{console.log("Email Changed Successfully")}).catch(e=>{console.log("ERROR: "+e.message)})}}]});return yield e.present()}))}updatePassword(){return Object(l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._alertController.create({inputs:[{name:"newPassword",placeholder:"New password",type:"password"},{name:"oldPassword",placeholder:"Old password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:e=>{this.profileService.updatePassword(e.newPassword,e.oldPassword)}}]});return yield e.present()}))}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(c.a),s.Kb(n.b),s.Kb(u.a),s.Kb(a.g),s.Kb(p))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-perfil"]],decls:47,vars:5,consts:[["color","primary"],["slot","end"],["src","https://firebasestorage.googleapis.com/v0/b/sophi-optimism-2020.appspot.com/o/imagenes%2Fimgsocial.png?alt=media&token=70bd5960-b560-415b-a90b-7cc1383d71ab"],[2,"font-weight","600","color","rgba(39, 39, 39, 0.81)","font-size","16px"],[2,"font-weight","600","color","rgb(133, 133, 133)","font-size","14px"],[1,"profile-pic",3,"click"],[3,"src"],[3,"click"],["size","5",1,"text-left"],["class","text-center","size","7",4,"ngIf"],["size","7","class","placeholder-profile text-center",4,"ngIf"],["size","7",1,"placeholder-profile"],["size","7",1,"text-center"],["size","7",1,"placeholder-profile","text-center"]],template:function(e,t){1&e&&(s.Nb(0,"ion-header"),s.Nb(1,"ion-toolbar",0),s.Nb(2,"ion-avatar",1),s.Lb(3,"img",2),s.Mb(),s.Nb(4,"ion-card-content"),s.Nb(5,"h4",3),s.ic(6," Perfil "),s.Mb(),s.Nb(7,"h6",4),s.ic(8," Algunas ideas importantes. "),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(9,"ion-content"),s.Nb(10,"ion-avatar",5),s.Vb("click",(function(){return t.selectImageSource()})),s.Lb(11,"ion-img",6),s.Mb(),s.Nb(12,"ion-card"),s.Nb(13,"ion-card-header"),s.Nb(14,"ion-card-title"),s.ic(15,"Perfil BePositive"),s.Mb(),s.Mb(),s.Nb(16,"ion-card-content"),s.ic(17," Ejemplo del perfil de un usuario "),s.Mb(),s.Mb(),s.Nb(18,"ion-list"),s.Nb(19,"ion-item-divider"),s.Nb(20,"ion-label"),s.ic(21,"Informaci\xf3n Personal"),s.Mb(),s.Mb(),s.Mb(),s.Nb(22,"ion-item",7),s.Vb("click",(function(){return t.updateName()})),s.Nb(23,"ion-label"),s.Nb(24,"ion-grid"),s.Nb(25,"ion-row"),s.Nb(26,"ion-col",8),s.ic(27," Nombre "),s.Mb(),s.hc(28,h,2,1,"ion-col",9),s.hc(29,f,3,0,"ion-col",10),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(30,"ion-item",7),s.Vb("click",(function(){return t.updateEmail()})),s.Nb(31,"ion-label"),s.Nb(32,"ion-grid"),s.Nb(33,"ion-row"),s.Nb(34,"ion-col",8),s.ic(35," Email "),s.Mb(),s.hc(36,m,2,1,"ion-col",9),s.hc(37,g,3,0,"ion-col",10),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(38,"ion-item",7),s.Vb("click",(function(){return t.updatePassword()})),s.Nb(39,"ion-label"),s.Nb(40,"ion-grid"),s.Nb(41,"ion-row"),s.Nb(42,"ion-col",8),s.ic(43," Password "),s.Mb(),s.Nb(44,"ion-col",11),s.Nb(45,"span"),s.ic(46," Toque aqu\xed para editar. "),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb()),2&e&&(s.Ab(11),s.ac("src",t.myProfileImage),s.Ab(17),s.ac("ngIf",null==t.userProfile?null:t.userProfile.fullName),s.Ab(1),s.ac("ngIf",!(null!=t.userProfile&&t.userProfile.fullName)),s.Ab(7),s.ac("ngIf",null==t.userProfile?null:t.userProfile.email),s.Ab(1),s.ac("ngIf",!(null!=t.userProfile&&t.userProfile.email)))},directives:[n.v,n.O,n.d,n.j,n.o,n.x,n.i,n.k,n.m,n.D,n.A,n.C,n.z,n.u,n.H,n.n,r.i],styles:[".profile-pic[_ngcontent-%COMP%]{width:200px;height:200px;border:1px solid grey;margin:10px auto}"]}),e})()}];let N=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(P)],a.i]}),e})(),y=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[r.b,o.d,n.P,N]]}),e})()}}]);